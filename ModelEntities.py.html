<html>
<head>
<title>ModelEntities.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #629755; font-style: italic;}
.s3 { color: #808080;}
.s4 { color: #6a8759;}
.s5 { color: #6897bb;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
ModelEntities.py</font>
</center></td></tr></table>
<pre><span class="s0">from </span><span class="s1">ModelEvents </span><span class="s0">import </span><span class="s1">Arrival</span><span class="s0">, </span><span class="s1">EndOfExam</span><span class="s0">, </span><span class="s1">EndOfMentalHealthConsult</span>

<span class="s0">class </span><span class="s1">Patient:</span>
    <span class="s0">def </span><span class="s1">__init__(self</span><span class="s0">, </span><span class="s1">id</span><span class="s0">, </span><span class="s1">if_with_depression):</span>
        <span class="s2">&quot;&quot;&quot; create a patient 
        :param id: (integer) patient ID 
        :param if_with_depression: (bool) set to true if the patient has depression 
        &quot;&quot;&quot;</span>
        <span class="s1">self.id = id</span>
        <span class="s1">self.ifWithDepression = if_with_depression</span>
        <span class="s1">self.tArrived = </span><span class="s0">None  </span><span class="s3"># time the patient arrived</span>
        <span class="s1">self.tJoinedWaitingRoomExam = </span><span class="s0">None  </span><span class="s3"># time the patient joined the waiting room</span>
        <span class="s1">self.tJoinedMHWaitingRoom = </span><span class="s0">None</span>
        <span class="s1">self.tLeftWaitingRoom = </span><span class="s0">None  </span><span class="s3"># time the patient left the waiting room</span>
        <span class="s1">self.tLeftMHWaitingRoom = </span><span class="s0">None</span>

    <span class="s0">def </span><span class="s1">__str__(self):</span>
        <span class="s0">return </span><span class="s4">&quot;Patient &quot; </span><span class="s1">+ str(self.id)</span>
<span class="s0">class </span><span class="s1">WaitingRoom:</span>
    <span class="s0">def </span><span class="s1">__init__(self</span><span class="s0">, </span><span class="s1">sim_out</span><span class="s0">, </span><span class="s1">trace</span><span class="s0">, </span><span class="s1">room_type):</span>
        <span class="s2">&quot;&quot;&quot; create a waiting room 
        :param sim_out: simulation output 
        :param trace: simulation trace 
        &quot;&quot;&quot;</span>
        <span class="s1">self.patientsWaiting = []   </span><span class="s3"># list of patients in the waiting room</span>
        <span class="s1">self.patientsWaitingForConsult = []</span>
        <span class="s1">self.simOut = sim_out</span>
        <span class="s1">self.trace = trace</span>
        <span class="s1">self.roomType = room_type</span>

    <span class="s0">def </span><span class="s1">add_patient(self</span><span class="s0">, </span><span class="s1">patient):</span>
        <span class="s2">&quot;&quot;&quot; add a patient to the waiting room 
        :param patient: a patient to be added to the waiting room 
        &quot;&quot;&quot;</span>
        <span class="s3"># update statistics for the patient who joins the waiting room</span>
        <span class="s1">self.simOut.collect_patient_joining_waiting_room(patient=patient</span><span class="s0">, </span><span class="s1">room_type=self.roomType)</span>
        <span class="s3"># add the patient to the list of patients waiting</span>
        <span class="s1">self.patientsWaiting.append(patient)</span>

        <span class="s3"># trace</span>
        <span class="s0">if </span><span class="s1">self.roomType == </span><span class="s4">&quot;mental_health_consultation&quot;</span><span class="s1">:</span>
            <span class="s1">self.trace.add_message(</span>
                <span class="s1">str(patient) + </span><span class="s4">' joins the MH waiting room. Number waiting = ' </span><span class="s1">+ str(</span>
                    <span class="s1">len(self.patientsWaiting))</span>
            <span class="s1">)</span>
        <span class="s0">else</span><span class="s1">:  </span><span class="s3"># For physician examination waiting room</span>
            <span class="s1">self.trace.add_message(</span>
                <span class="s1">str(patient) + </span><span class="s4">' joins the waiting room for physician examination. Number waiting = ' </span><span class="s1">+ str(</span>
                    <span class="s1">len(self.patientsWaiting))</span>
            <span class="s1">)</span>


    <span class="s0">def </span><span class="s1">get_next_patient(self):</span>
        <span class="s2">&quot;&quot;&quot; 
        :returns: the next patient in line 
        &quot;&quot;&quot;</span>

        <span class="s3"># update statistics for the patient who leaves the waiting room</span>
        <span class="s1">self.simOut.collect_patient_leaving_waiting_room(patient=self.patientsWaiting[</span><span class="s5">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">room_type=self.roomType)</span>

        <span class="s3"># trace</span>
        <span class="s0">if </span><span class="s1">self.roomType == </span><span class="s4">&quot;mental_health_consultation&quot;</span><span class="s1">:</span>
            <span class="s1">self.trace.add_message(</span>
                <span class="s1">str(self.patientsWaiting[</span><span class="s5">0</span><span class="s1">]) + </span><span class="s4">' leaves the MH waiting room. Number waiting = '</span>
                <span class="s1">+ str(len(self.patientsWaiting) - </span><span class="s5">1</span><span class="s1">) + </span><span class="s4">'.'</span><span class="s1">)</span>

        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">self.trace.add_message(</span>
                <span class="s1">str(self.patientsWaiting[</span><span class="s5">0</span><span class="s1">]) + </span><span class="s4">' leaves the physician waiting room. Number waiting = '</span>
                <span class="s1">+ str(len(self.patientsWaiting) - </span><span class="s5">1</span><span class="s1">) + </span><span class="s4">'.'</span><span class="s1">)</span>

        <span class="s3"># pop the patient</span>
        <span class="s0">return </span><span class="s1">self.patientsWaiting.pop(</span><span class="s5">0</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">get_num_patients_waiting(self):</span>
        <span class="s2">&quot;&quot;&quot; 
        :return: the number of patient waiting in the waiting room 
        &quot;&quot;&quot;</span>
        <span class="s0">return </span><span class="s1">len(self.patientsWaiting)</span>

<span class="s0">class </span><span class="s1">Physician:</span>
    <span class="s0">def </span><span class="s1">__init__(self</span><span class="s0">, </span><span class="s1">id</span><span class="s0">, </span><span class="s1">service_time_dist</span><span class="s0">, </span><span class="s1">urgent_care</span><span class="s0">, </span><span class="s1">sim_cal</span><span class="s0">, </span><span class="s1">sim_out</span><span class="s0">, </span><span class="s1">trace):</span>
        <span class="s2">&quot;&quot;&quot; create a physician 
        :param id: (integer) the physician ID 
        :param service_time_dist: distribution of service time 
        :param urgent_care: urgent care 
        :param sim_cal: simulation calendar 
        &quot;&quot;&quot;</span>
        <span class="s1">self.id = id</span>
        <span class="s1">self.serviceTimeDist = service_time_dist</span>
        <span class="s1">self.urgentCare = urgent_care</span>
        <span class="s1">self.simCal = sim_cal</span>
        <span class="s1">self.simOut = sim_out</span>
        <span class="s1">self.trace = trace</span>
        <span class="s1">self.isBusy = </span><span class="s0">False</span>
        <span class="s1">self.patientBeingServed = </span><span class="s0">None  </span><span class="s3"># the patient who is being served</span>

    <span class="s0">def </span><span class="s1">__str__(self):</span>
        <span class="s2">&quot;&quot;&quot; :returns (string) the physician id &quot;&quot;&quot;</span>
        <span class="s0">return </span><span class="s4">&quot;Physician &quot; </span><span class="s1">+ str(self.id)</span>

    <span class="s0">def </span><span class="s1">remove_patient(self):</span>
        <span class="s2">&quot;&quot;&quot; :returns the patient that was being served by this physician &quot;&quot;&quot;</span>

        <span class="s3"># store the patient to be returned</span>
        <span class="s1">returned_patient = self.patientBeingServed</span>


        <span class="s3"># set the patient that was being served to None</span>
        <span class="s1">self.patientBeingServed = </span><span class="s0">None</span>

        <span class="s3"># the physician is idle now</span>
        <span class="s1">self.isBusy = </span><span class="s0">False</span>

        <span class="s3"># return the patient that was being served</span>
        <span class="s0">return </span><span class="s1">returned_patient</span>

<span class="s0">class </span><span class="s1">PCP(Physician):</span>
    <span class="s0">def </span><span class="s1">__init__(self</span><span class="s0">, </span><span class="s1">id</span><span class="s0">, </span><span class="s1">service_time_dist</span><span class="s0">, </span><span class="s1">urgent_care</span><span class="s0">, </span><span class="s1">sim_cal</span><span class="s0">, </span><span class="s1">sim_out</span><span class="s0">, </span><span class="s1">trace):</span>
        <span class="s2">&quot;&quot;&quot; create a primary care physician 
        :param id: (integer) id 
        :param service_time_dist: distribution of service time in this exam room 
        :param urgent_care: urgent care 
        :param sim_cal: simulation calendar 
        &quot;&quot;&quot;</span>
        <span class="s1">Physician.__init__(self</span><span class="s0">, </span><span class="s1">id=id</span><span class="s0">, </span><span class="s1">service_time_dist=service_time_dist</span><span class="s0">, </span><span class="s1">urgent_care=urgent_care</span><span class="s0">, </span><span class="s1">sim_cal=sim_cal</span><span class="s0">, </span><span class="s1">sim_out=sim_out</span><span class="s0">,</span><span class="s1">trace=trace)</span>

    <span class="s0">def </span><span class="s1">exam(self</span><span class="s0">, </span><span class="s1">patient</span><span class="s0">, </span><span class="s1">rng):</span>
        <span class="s2">&quot;&quot;&quot; starts examining the patient 
        :param patient: a patient 
        :param rng: random number generator 
        &quot;&quot;&quot;</span>

        <span class="s3"># the physician is busy</span>
        <span class="s1">self.patientBeingServed = patient</span>
        <span class="s1">self.isBusy = </span><span class="s0">True</span>

        <span class="s3"># trace</span>
        <span class="s1">self.trace.add_message(str(patient) + </span><span class="s4">' starts service in ' </span><span class="s1">+ str(self))</span>
        <span class="s3"># collect statistics</span>
        <span class="s1">self.simOut.collect_patient_starting_exam()</span>

        <span class="s3"># find the exam completion time (current time + service time)</span>
        <span class="s1">exam_completion_time = self.simCal.time + self.serviceTimeDist.sample(rng=rng)</span>

        <span class="s3"># schedule the end of exam</span>
        <span class="s1">self.simCal.add_event(</span>
            <span class="s1">event=EndOfExam(time=exam_completion_time</span><span class="s0">, </span><span class="s1">physician=self</span><span class="s0">, </span><span class="s1">urgent_care=self.urgentCare)</span>
        <span class="s1">)</span>

<span class="s0">class </span><span class="s1">MHP(Physician):</span>
    <span class="s0">def </span><span class="s1">__init__(self</span><span class="s0">, </span><span class="s1">id</span><span class="s0">, </span><span class="s1">service_time_dist</span><span class="s0">, </span><span class="s1">urgent_care</span><span class="s0">, </span><span class="s1">sim_cal</span><span class="s0">, </span><span class="s1">sim_out</span><span class="s0">, </span><span class="s1">trace):</span>
        <span class="s2">&quot;&quot;&quot; create a mental health physician 
        :param id: (integer) the room ID 
        :param service_time_dist: distribution of service time 
        :param urgent_care: urgent care 
        :param sim_cal: simulation calendar 
        &quot;&quot;&quot;</span>
        <span class="s1">Physician.__init__(self</span><span class="s0">, </span><span class="s1">id=id</span><span class="s0">, </span><span class="s1">service_time_dist=service_time_dist</span><span class="s0">, </span><span class="s1">urgent_care=urgent_care</span><span class="s0">, </span><span class="s1">sim_cal=sim_cal</span><span class="s0">,</span><span class="s1">sim_out=sim_out</span><span class="s0">,</span><span class="s1">trace=trace)</span>

    <span class="s0">def </span><span class="s1">consult(self</span><span class="s0">, </span><span class="s1">patient</span><span class="s0">, </span><span class="s1">rng):</span>
        <span class="s2">&quot;&quot;&quot; starts mental health consultation for this patient 
        :param patient: a patient 
        :param rng: random number generator 
        &quot;&quot;&quot;</span>

        <span class="s3"># the room is busy</span>
        <span class="s1">self.patientBeingServed = patient</span>
        <span class="s1">self.isBusy = </span><span class="s0">True</span>

        <span class="s3"># trace</span>
        <span class="s1">self.trace.add_message(str(patient) + </span><span class="s4">' starts consultation in ' </span><span class="s1">+ str(self))</span>
        <span class="s3"># collect statistics</span>
        <span class="s1">self.simOut.collect_patient_starting_MH()</span>

        <span class="s3"># find the exam completion time (current time + service time)</span>
        <span class="s1">exam_completion_time = self.simCal.time + self.serviceTimeDist.sample(rng=rng)</span>

        <span class="s3"># schedule the end of exam</span>
        <span class="s1">self.simCal.add_event(</span>
            <span class="s1">event=EndOfMentalHealthConsult(time=exam_completion_time</span><span class="s0">, </span><span class="s1">consult_room=self</span><span class="s0">, </span><span class="s1">urgent_care=self.urgentCare)</span>
        <span class="s1">)</span>

<span class="s0">class </span><span class="s1">UrgentCare:</span>
    <span class="s0">def </span><span class="s1">__init__(self</span><span class="s0">, </span><span class="s1">id</span><span class="s0">, </span><span class="s1">parameters</span><span class="s0">, </span><span class="s1">sim_cal</span><span class="s0">, </span><span class="s1">sim_out</span><span class="s0">, </span><span class="s1">trace):</span>
        <span class="s2">&quot;&quot;&quot; creates an urgent care 
        :param id: ID of this urgent care 
        :param sim_cal: simulation calendar 
        :parameters: parameters of this urgent care 
        &quot;&quot;&quot;</span>

        <span class="s1">self.id = id                   </span><span class="s3"># urgent care id</span>
        <span class="s1">self.params = parameters  </span><span class="s3"># parameters of this urgent care</span>
        <span class="s1">self.simCal = sim_cal</span>
        <span class="s1">self.simOutputs = sim_out</span>
        <span class="s1">self.trace = trace</span>
        <span class="s1">self.ifOpen = </span><span class="s0">True  </span><span class="s3"># if the urgent care is open and admitting new patients</span>

        <span class="s3"># waiting room</span>
        <span class="s1">self.waitingRoom = WaitingRoom(sim_out=self.simOutputs</span><span class="s0">,</span>
                                       <span class="s1">trace=self.trace</span><span class="s0">, </span><span class="s1">room_type=</span><span class="s4">&quot;physician_exam&quot;</span><span class="s1">)</span>

        <span class="s3"># primary care physicians</span>
        <span class="s1">self.PCPs = []</span>
        <span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range(</span><span class="s5">0</span><span class="s0">, </span><span class="s1">self.params.nPCPs):</span>
            <span class="s1">self.PCPs.append(PCP(id=i</span><span class="s0">,</span>
                                 <span class="s1">service_time_dist=self.params.examTimeDist</span><span class="s0">,</span>
                                 <span class="s1">urgent_care=self</span><span class="s0">,</span>
                                 <span class="s1">sim_cal=self.simCal</span><span class="s0">,</span>
                                 <span class="s1">sim_out=self.simOutputs</span><span class="s0">,</span>
                                 <span class="s1">trace=self.trace))</span>

        <span class="s3"># waiting room for mental health consultation</span>
        <span class="s1">self.mhConsultWaitingRoom = WaitingRoom(sim_out=self.simOutputs</span><span class="s0">,</span>
                                       <span class="s1">trace=self.trace</span><span class="s0">, </span><span class="s1">room_type=</span><span class="s4">&quot;physician_exam&quot;</span><span class="s1">)</span>

        <span class="s3"># create the mental health physician</span>
        <span class="s1">self.MHP = MHP(id=</span><span class="s5">0</span><span class="s0">,</span>
                       <span class="s1">service_time_dist=self.params.mentalHealthConsultDist</span><span class="s0">,</span>
                       <span class="s1">urgent_care=self</span><span class="s0">,</span>
                       <span class="s1">sim_cal=self.simCal</span><span class="s0">,</span>
                       <span class="s1">sim_out=self.simOutputs</span><span class="s0">,</span>
                       <span class="s1">trace=self.trace</span>
                       <span class="s1">)</span>

        <span class="s3"># statistics</span>
        <span class="s3"># self.nPatientsArrived = 0  # number of patients arrived</span>
        <span class="s1">self.nPatientsServed = </span><span class="s5">0  </span><span class="s3"># number of patients served</span>
        <span class="s3"># self.nPatientsReceivedConsult = 0  # number of patients received mental health consultation</span>

    <span class="s0">def </span><span class="s1">process_new_patient(self</span><span class="s0">, </span><span class="s1">patient</span><span class="s0">, </span><span class="s1">rng):</span>
        <span class="s2">&quot;&quot;&quot; receives a new patient 
        :param patient: the new patient 
        :param rng: random number generator 
        &quot;&quot;&quot;</span>
        <span class="s3"># trace</span>
        <span class="s1">self.trace.add_message(</span>
            <span class="s4">'Processing arrival of ' </span><span class="s1">+ str(patient) + </span><span class="s4">'.'</span><span class="s1">)</span>

        <span class="s3"># do not admit the patient if the urgent care is closed</span>
        <span class="s0">if not </span><span class="s1">self.ifOpen:</span>
            <span class="s1">self.trace.add_message(</span><span class="s4">'Urgent care is closed. ' </span><span class="s1">+ str(patient) + </span><span class="s4">' does not get admitted.'</span><span class="s1">)</span>
            <span class="s0">return</span>
        <span class="s3"># collect statistics on new patient</span>
        <span class="s1">self.simOutputs.collect_patient_arrival(patient=patient)</span>
        <span class="s3"># self.nPatientsArrived += 1</span>

        <span class="s3"># check if anyone is waiting</span>
        <span class="s0">if </span><span class="s1">self.waitingRoom.get_num_patients_waiting() &gt; </span><span class="s5">0</span><span class="s1">:</span>
            <span class="s3"># if anyone is waiting, add the patient to the waiting room</span>
            <span class="s1">self.waitingRoom.add_patient(patient=patient)</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s3"># find an idle physician</span>
            <span class="s1">idle_pcp_found = </span><span class="s0">False</span>
            <span class="s0">for </span><span class="s1">pcp </span><span class="s0">in </span><span class="s1">self.PCPs:</span>
                <span class="s3"># if this pcp is busy</span>
                <span class="s0">if not </span><span class="s1">pcp.isBusy:</span>
                    <span class="s3"># send the last patient to this pcp</span>
                    <span class="s1">pcp.exam(patient=patient</span><span class="s0">, </span><span class="s1">rng=rng)</span>
                    <span class="s1">idle_pcp_found = </span><span class="s0">True</span>
                    <span class="s3"># break the for loop</span>
                    <span class="s0">break</span>

            <span class="s3"># if no idle pcp was found</span>
            <span class="s0">if not </span><span class="s1">idle_pcp_found:</span>
                <span class="s3"># add the patient to the waiting room</span>
                <span class="s1">self.waitingRoom.add_patient(patient=patient)</span>

        <span class="s3"># find the arrival time of the next patient (current time + time until next arrival)</span>
        <span class="s1">next_arrival_time = self.simCal.time + self.params.arrivalTimeDist.sample(rng=rng)</span>

        <span class="s3"># find the depression status of the next patient</span>
        <span class="s1">if_with_depression = </span><span class="s0">False</span>
        <span class="s0">if </span><span class="s1">rng.random_sample() &lt; self.params.probDepression:</span>
            <span class="s1">if_with_depression = </span><span class="s0">True</span>

        <span class="s3"># schedule the arrival of the next patient</span>
        <span class="s1">self.simCal.add_event(</span>
            <span class="s1">event=Arrival(</span>
                <span class="s1">time=next_arrival_time</span><span class="s0">,</span>
                <span class="s1">patient=Patient(id=patient.id + </span><span class="s5">1</span><span class="s0">, </span><span class="s1">if_with_depression=if_with_depression)</span><span class="s0">,</span>
                <span class="s1">urgent_care=self</span>
            <span class="s1">)</span>
        <span class="s1">)</span>

    <span class="s0">def </span><span class="s1">process_end_of_exam(self</span><span class="s0">, </span><span class="s1">pcp</span><span class="s0">, </span><span class="s1">rng):</span>
        <span class="s2">&quot;&quot;&quot; processes the end of exam for this primary care physician 
        :param pcp: the pcp that finished the exam 
        :param rng: random number generator 
        &quot;&quot;&quot;</span>
        <span class="s3"># trace</span>
        <span class="s1">self.trace.add_message(</span><span class="s4">'Processing the end of exam for ' </span><span class="s1">+ str(pcp) + </span><span class="s4">'.'</span><span class="s1">)</span>
        <span class="s3"># get the patient who is about to be discharged</span>
        <span class="s1">this_patient = pcp.remove_patient()</span>

        <span class="s3"># check the mental health status of the patient</span>
        <span class="s0">if </span><span class="s1">this_patient.ifWithDepression:</span>
            <span class="s3"># trace</span>
            <span class="s1">self.trace.add_message(</span>
                <span class="s4">'Processing arrival of ' </span><span class="s1">+ str(this_patient) + </span><span class="s4">'to MH care.'</span><span class="s1">)</span>
            <span class="s3"># collect statistics on new patient</span>
            <span class="s1">self.simOutputs.collect_patient_arrival_MH(patient=this_patient) </span><span class="s3">#if not, try patient only</span>
            <span class="s3"># send the patient to the mental health specialist</span>
            <span class="s3"># if the mental health specialist is busy</span>
            <span class="s0">if </span><span class="s1">self.MHP.isBusy:</span>
                <span class="s3"># the patient will join the waiting room in the mental health unity</span>
                <span class="s1">self.mhConsultWaitingRoom.add_patient(patient=this_patient)</span>
            <span class="s0">else</span><span class="s1">:</span>
                <span class="s3"># this patient starts receiving mental health consultation</span>
                <span class="s1">self.MHP.consult(patient=this_patient</span><span class="s0">, </span><span class="s1">rng=rng)</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s3"># remove the discharged patient from the list of patients</span>
            <span class="s3"># collect statistics</span>
            <span class="s1">self.simOutputs.collect_patient_departure_exam(patient=this_patient)</span>

            <span class="s3"># trace</span>
            <span class="s1">self.trace.add_message(str(this_patient) + </span><span class="s4">' leaves exam and system ' </span><span class="s1">+ str(self) + </span><span class="s4">'.'</span><span class="s1">)</span>

            <span class="s3"># self.nPatientsServed += 1 # remove this portion from departure_exam then in SimOutput</span>

        <span class="s3"># check if there is any patient waiting</span>
        <span class="s0">if </span><span class="s1">self.waitingRoom.get_num_patients_waiting() &gt; </span><span class="s5">0</span><span class="s1">:</span>
            <span class="s3"># start serving the next patient in line</span>
            <span class="s1">pcp.exam(patient=self.waitingRoom.get_next_patient()</span><span class="s0">, </span><span class="s1">rng=rng)</span>

    <span class="s0">def </span><span class="s1">process_end_of_consultation(self</span><span class="s0">, </span><span class="s1">mhp</span><span class="s0">, </span><span class="s1">rng):</span>
        <span class="s2">&quot;&quot;&quot; process the end of mental health consultation 
        :param mhp: mental health physician 
        :param rng: random number generator 
        &quot;&quot;&quot;</span>
        <span class="s3"># trace</span>
        <span class="s1">self.trace.add_message(</span><span class="s4">'Processing the end of consultation for MH Specialist.'</span><span class="s1">)</span>

        <span class="s3"># get the patient who is about to be discharged</span>
        <span class="s1">this_patient = mhp.remove_patient()</span>

        <span class="s3"># remove the discharged patient from the list of patients</span>

        <span class="s3"># self.nPatientsServed += 1</span>
        <span class="s3"># self.nPatientsReceivedConsult += 1</span>
        <span class="s1">self.simOutputs.collect_patient_departure_MH(patient=this_patient)</span>
        <span class="s3"># trace</span>
        <span class="s1">self.trace.add_message(str(this_patient) + </span><span class="s4">' leaves consultation and system ' </span><span class="s1">+ str(self) + </span><span class="s4">'.'</span><span class="s1">)</span>

        <span class="s3"># check if there is any patient waiting</span>
        <span class="s0">if </span><span class="s1">self.mhConsultWaitingRoom.get_num_patients_waiting() &gt; </span><span class="s5">0</span><span class="s1">:</span>
            <span class="s3"># start serving the next patient in line</span>
            <span class="s1">mhp.consult(patient=self.mhConsultWaitingRoom.get_next_patient()</span><span class="s0">, </span><span class="s1">rng=rng)</span>

    <span class="s0">def </span><span class="s1">process_close_urgent_care(self):</span>
        <span class="s2">&quot;&quot;&quot; process the closing of the urgent care &quot;&quot;&quot;</span>
        <span class="s3"># trace</span>
        <span class="s1">self.trace.add_message(</span><span class="s4">'Processing the closing of the urgent care.'</span><span class="s1">)</span>
        <span class="s3"># close the urgent care</span>
        <span class="s1">self.ifOpen = </span><span class="s0">False</span>


</pre>
</body>
</html>